<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:secure-properties="http://www.mulesoft.org/schema/mule/secure-properties" xmlns:db="http://www.mulesoft.org/schema/mule/db"
	xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/secure-properties http://www.mulesoft.org/schema/mule/secure-properties/current/mule-secure-properties.xsd">
	<http:request-config name="HTTP_Request_configuration" doc:name="HTTP Request configuration" doc:id="a4ffb57c-497a-4fe7-b970-969d8ed9b2d0" basePath="${ballapi.basepath}" >
		<http:request-connection host="${ballapi.host}" />
	</http:request-config>
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="d7600e0c-5a23-47d7-8224-a66375aa7634" >
		<http:listener-connection host="0.0.0.0" port="${http.port}" />
	</http:listener-config>
	<configuration-properties doc:name="Configuration properties" doc:id="e577ab23-8814-4cb3-b302-5f03ccccb8e8" file="config.yaml" />
	<db:config name="Database_Config" doc:name="Database Config" doc:id="e95af0e1-7b25-4b80-b4f0-1064fd394717" >
		<db:generic-connection url="${database.URL}" driverClassName="${database.driver}" user="${secure::database.user}" password="${secure::database.password}" />
	</db:config>
	<secure-properties:config name="Secure_Properties_Config" doc:name="Secure Properties Config" doc:id="c29dec6b-cf34-4385-89e5-cb4919a118b0" file="config.yaml" key="demo" >
		<secure-properties:encrypt algorithm="Blowfish" />
	</secure-properties:config>
	<error-handler name="globalError_Handler" doc:id="1d06f253-04ba-4be3-84c2-c69d8b34b155" >
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="41826be5-e342-428e-bbc2-f849224e1690" type="APIKIT:BAD_REQUEST" >
			<ee:transform doc:name="Transform Message" doc:id="3bbbef21-6eec-491f-82e1-a30dfc1c3d4d" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{message: "Bad request"}]]></ee:set-payload>
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="httpStatus" ><![CDATA[400]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="be175dcb-b947-46a9-b184-813503f785dc" type="APIKIT:NOT_FOUND" >
			<ee:transform doc:name="Transform Message" doc:id="efa50b17-43ed-4bfc-8b8a-54d4ac66f1cd" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{message: "Resource not found"}]]></ee:set-payload>
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="httpStatus" ><![CDATA[404]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="d6c1a1fb-4486-4b4a-836d-ccdb1779a038" type="APIKIT:METHOD_NOT_ALLOWED" >
			<ee:transform doc:name="Transform Message" doc:id="a9b54853-cd7d-4289-9cf4-08ae1299a73c" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{message: "Method not allowed"}]]></ee:set-payload>
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="httpStatus" ><![CDATA[405]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="39a85ebc-5674-41f3-9336-84ec6ce17a9c" type="APIKIT:NOT_ACCEPTABLE" >
			<ee:transform doc:name="Transform Message" doc:id="a8083dfc-a576-4418-9900-cb28ad247e11" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{message: "Not acceptable"}]]></ee:set-payload>
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="httpStatus" ><![CDATA[406]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="27cadab7-a366-453e-a047-f9c64fbfee37" type="APIKIT:UNSUPPORTED_MEDIA_TYPE" >
			<ee:transform doc:name="Transform Message" doc:id="5cc7f7e4-0ae4-4ec9-b17c-303fa4aafebf" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{message: "Unsupported media type"}]]></ee:set-payload>
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="httpStatus" ><![CDATA[415]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="143829e2-3493-429e-a7c6-30cecfef261b" type="APIKIT:NOT_IMPLEMENTED" >
			<ee:transform doc:name="Transform Message" doc:id="7b5045f7-ae2e-49b5-9c41-9f4ab921658b" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{message: "Not Implemented"}]]></ee:set-payload>
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="httpStatus" ><![CDATA[501]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
	</error-handler>
	<error-handler name="Api_Error_Handler" doc:id="3af1e10b-b377-4bd6-b1c3-0330d3b062e3" >
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="e2bf4987-093f-42e5-8b33-0aec2a67766b" type="APP:NAMEVALIDATION">
			<ee:transform doc:name="Transform Message" doc:id="1d03ee99-58ad-4ff5-9959-90ed5bf70d75" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
message: "Invalid Name Of The Team",
teamname: vars.teamName
}]]></ee:set-payload>
				</ee:message>
			</ee:transform>
			<set-variable value="400" doc:name="httpStatus" doc:id="eda18a35-19db-471c-a6b4-4d1d362e6fcc" variableName="httpStatus" />
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="4c19d2fe-4703-4000-b2fd-241852aef204" type="APP:ABBRVALIDATION" >
			<ee:transform doc:name="Transform Message" doc:id="cf3214d6-9186-407e-8697-87e6487ddede" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
message: "Invalid Abbreviation Of The Team",
abbreviation: vars.teamAbr
}]]></ee:set-payload>
				</ee:message>
			</ee:transform>
			<set-variable value="400" doc:name="httpStatus" doc:id="bc935bdf-5a79-40d7-bda5-2ef0b2a29bf4" variableName="httpStatus" />
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="Copy_of_On Error Propagate" doc:id="ea1a92b0-e226-4964-827f-c9206d52a5b4" type="APP:SEASONVALIDATION">
			<ee:transform doc:name="Transform Message" doc:id="0a5a48a8-650d-4d66-8747-380e7f3c980c" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
message: "Season Must Be Between 1980 AND 2021",
season: vars.season
}]]></ee:set-payload>
				</ee:message>
			</ee:transform>
			<set-variable value="400" doc:name="httpStatus" doc:id="4cc34188-808b-4db5-9195-f9110a324e0f" variableName="httpStatus" />
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="6991be2a-cf67-4f32-9f32-98e685c9179d" type="APP:STANDIGSBYVALIDATION">
			<ee:transform doc:name="Transform Message" doc:id="97e316ea-235e-43bc-a404-6de2178d2c0d" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
message: "Choose division or conference or leave empty",
standingsBy: vars.standingsBy
}]]></ee:set-payload>
				</ee:message>
			</ee:transform>
			<set-variable value="400" doc:name="httpStatus" doc:id="8097c73d-5df5-410b-a708-9517f1db8aef" variableName="httpStatus" />
		</on-error-propagate>
	</error-handler>
</mule>
